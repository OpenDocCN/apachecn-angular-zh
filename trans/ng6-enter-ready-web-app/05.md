# 十五、使用材质提供高质量的用户体验

在*第 4 章*、*自动测试、CI 和发布到生产*中，我们提到了交付高质量应用的需要。目前，这款应用的外观和感觉都很糟糕，只适合上世纪 90 年代后期创建的网站。用户或客户对您的产品或工作的第一印象是非常重要的，因此我们必须能够创建一个美观的应用，该应用还可以跨移动和桌面浏览器提供出色的用户体验。

作为全栈开发人员，很难专注于应用的完善。当应用的功能集快速增长时，情况往往会变得更糟。编写优秀的模块化代码支持您的视图并不是一件有趣的事情，但是为了改进应用的外观和感觉，您会匆忙地使用 CSS 技巧和内联样式。

与棱角材质紧密配合开发，棱角材质令人惊叹。如果您学会了如何有效地利用 Angular 材质，那么无论您是在小型还是大型应用上工作，您创建的功能从一开始就会非常出色。

Angular Material 将使您成为一名更有效的 web 开发人员，因为它附带了多种用户控件，您可以利用这些控件，而且您不必担心浏览器的兼容性。作为额外的好处，编写自定义 CSS 将成为一件稀罕事。

虽然本章介绍了如何创建一个有吸引力的**用户界面**（**UI**）依赖于棱角材质，以获得一个像样的**用户体验**（**UX**）开箱即用，但知道什么不该做也很重要。在[有一个名为“用户界面”的很棒的网站，它展示了 UI/UX 最糟糕的做法 https://userinyerface.com](https://userinyerface.com) 。

在本章中，您将了解以下内容：

*   作为 UI/UX 库区分 Angular 材质的各个方面
*   如何配置角材质
*   采用 Angular 柔性布局的响应性设计
*   使用 Angular 材质升级用户体验
*   通过**命令行界面**（**CLI**工具实施可访问性合规性
*   构建交互式原型

本书样本代码的最新版本在 GitHub 上，位于以下链接的存储库中。存储库包含代码的最终和完成状态。您可以在本章末尾通过在`projects`文件夹下查找代码的章末快照来验证您的进度。

对于*第五章*：

1.  克隆回购[https://github.com/duluca/local-weather-app](https://github.com/duluca/local-weather-app )
2.  在根文件夹上执行`npm install`以安装依赖项
3.  本章代码示例位于以下子文件夹下：

    ```ts
    projects/ch5 
    ```

4.  要运行本章的 Angular 应用，请执行：

    ```ts
    npx ng serve ch5 
    ```

5.  要运行本章的 Angular 单元测试，请执行：

    ```ts
    npx ng test ch5 --watch=false 
    ```

6.  要运行本章的 Angular e2e 测试，请执行：

    ```ts
    npx ng e2e ch5 
    ```

7.  要为本章构建生产就绪的 Angular 应用，请执行：

    ```ts
    npx ng build ch5 --prod 
    ```

请注意，存储库根目录下的`dist/ch5`文件夹将包含编译后的结果。

请注意，书中或 GitHub 上的源代码可能并不总是与 Angular CLI 生成的代码匹配。书中的代码和 GitHub 上的代码在实现上也可能有细微的差异，因为生态系统是不断发展的。随着时间的推移，示例代码自然会发生变化。同样在 GitHub 上，希望找到更正、修复以支持库的更新版本，或者多种技术的并行实现供您观察。您只需要实现书中推荐的理想解决方案。如果发现错误或有问题，请在 GitHub 上创建问题或提交请求，以方便所有读者。

让我们首先了解是什么使 Angular Material 成为 UI/UX 库的最佳选择。

# 角材质

Angle Material 项目的目标是提供一组有用的、标准化的高质量 UI 组件。该库实现了谷歌的材质设计规范，该规范在谷歌的移动应用、web 属性和 Android 操作系统中无处不在。材质设计具有特殊的数字和方形外观，但它不仅仅是另一个类似引导的 CSS 库。考虑使用 Bootstrap 编码的登录体验：

![](img/B14094_05_01.png)

图 5.1：引导登录体验

请注意，输入字段及其标签在单独的行上，复选框是要点击的小目标，错误消息显示为短暂的 toast 通知，**Submit**按钮就在角落里。现在，考虑下面的角材质样品：

![](img/B14094_05_02.png)

图 5.2：Angular 材质登录体验

输入字段及其标签最初是组合在一起的，以紧凑的形式吸引了用户的注意力。该复选框是触摸友好的，**提交**按钮在默认情况下会延伸，以占用可用空间，以提供更具响应性的用户体验。一旦用户单击某个字段，标签就会折叠到输入字段的左上角，如图所示：

![](img/B14094_05_03.png)

图 5.3：Angular 材质动画和错误

此外，验证错误消息以内联方式显示，并与标签中的颜色变化相结合，从而保持用户对输入字段的注意力。

材质设计帮助您设计具有自己品牌和样式的模块化用户界面，同时定义动画，使用户在使用应用时可以获得更好的用户体验。人脑下意识地跟踪物体及其位置。任何类型的动画都有助于过渡或对由人工输入导致的更改做出反应，从而减少用户的认知负荷，从而允许用户专注于处理内容，而不是试图找出特定应用的怪癖。

模块化用户界面设计和流畅的运动相结合，创造了出色的用户体验。看看 Angular 材质如何实现一个简单的按钮：

![](img/B14094_05_04.png)

角材质按钮 4.5

在前面的屏幕截图中，注意按钮上的点击动画是如何起源于用户点击的实际位置的。无论多么微妙，这都会产生连续性运动，从而对用户的动作产生适当的屏幕反应。当按钮在移动设备上使用时，这种特殊效果变得更加明显，从而实现更自然的人机交互。大多数用户无法清楚地说明是什么让直观的用户体验真正直观，而这些设计和体验中微妙但关键的线索让您在为用户设计这种体验方面取得了巨大的进步。

Angular Material 还旨在成为 Angular 的高质量 UI 组件的参考实现。如果您打算开发自己的自定义控件，那么 Angular 材质的源代码应该是您的首要资源。术语“高质量”经常被使用，量化其含义非常重要。Angular Material 团队将其很好地发布在他们的网站上：

> **什么是“高质量”？**
> 
> 国际化和可访问，以便所有用户都可以使用它们。直截了当的 API 不会让开发人员感到困惑，并且在各种各样的用例中表现出预期的行为，没有 bug。行为通过单元测试和集成测试都得到了很好的测试。可在材质设计规范的范围内自定义。性能成本最小化。代码是干净的，并且有很好的文档记录，可以作为 Angular 开发人员的示例。浏览器和屏幕阅读器支持。
> 
> Angular Material 支持所有主要浏览器的最新两个版本：Chrome（包括 Android）、Firefox、Safari（包括 iOS）和 IE11/Edge。

构建 web 应用，特别是那些同时兼容移动设备的应用，确实很困难。有很多细微差别你必须注意。Angular Material 将这些细微差别抽象出来，包括支持所有主要浏览器，以便您能够专注于创建应用。棱角材质不是时尚，也不能掉以轻心。如果使用得当，您可以大大提高工作效率和工作质量。

在项目中不可能总是使用 Angular 材质。我推荐在[中找到的任何一种底漆 https://www.primefaces.org/primeng](https://www.primefaces.org/primeng) 或清晰，位于[https://vmware.github.io/clarity](https://vmware.github.io/clarity) 作为组件工具包，可以满足大多数（如果不是全部）用户控制需求。这里要避免的一件事是从不同的来源提取几十个用户控件，最终得到一个大杂烩库，其中包含数百个需要学习、维护或解决的怪癖和错误。

在使用 UI 组件时，最重要的挑战之一是它们可以添加到应用包大小的批量。接下来，让我们看看使用内聚组件库如何帮助保持应用的性能，并为应用配置 Angular 材质。

# 角材质设置和性能

Angular 材质默认配置为优化最终交付物的包装尺寸。在 Angular JS 和 Angular Material 1.x 中，将加载整个依赖库。但是，现在使用角材质，我们可以只指定要使用的组件，从而显著提高性能。

在下表中，您可以看到，在高速低延迟光纤连接上，典型的 Angular 1.x+Angular 材质 1.x 与 Angular 6+材质 6 应用相比，其性能特征有所改善：

<colgroup><col> <col> <col> <col></colgroup> 
| **光纤网络** | **Angular 6+材质 6** | **Angular 1.5+材质 1.1.5** | **%差异** |
| 第一道漆（已加载）* | 0.61 秒 | 1.69 秒** | 大约快 2.8 倍 |
| JS 束大小* | 113 KB | 1425 KB | 12.6 倍小 |

*为了公平比较，结果中没有包括图像和其他媒体内容

**平均值：较低质量的基础结构会导致渲染时间从 0.9 秒到 2.5 秒不等

在高速低延迟连接的理想条件下，Angular 6+Material 6 应用在一秒钟内加载。然而，当我们将切换到更常见的中速、高延迟快速 3G 移动网络时，差异变得更加明显，如下表所示：

<colgroup><col> <col> <col> <col></colgroup> 
| **快速 3G 移动网络** | **Angular 6+材质 6** | **Angular 1.5+材质 1.1.5** | **%差异** |
| 第一道漆* | 1.94 秒 | 11.02 秒 | 快 5.7 倍 |
| JS 束大小* | 113 KB | 1425 KB | 12.6 倍小 |

*为了公平比较，结果中没有包括图像或其他媒体内容

尽管应用的大小差异保持一致，但您可以看到，移动网络带来的额外延迟会导致传统 Angular 应用的速度大幅降低到不可接受的水平。

将所有组件添加到材质中将导致约 1.3 MB 的额外有效负载需要交付给用户。从前面的比较中可以看出，必须不惜一切代价避免这种情况。要提供尽可能小的应用，这在移动和销售相关的场景中至关重要，因为每 100 毫秒的加载时间都会对用户保留产生影响，您可以单独加载和包含模块。Webpack 的摇树过程将模块划分为不同的文件，减少初始下载大小。

作为一个现实世界的例子，当您构建完 LocalCast 天气应用的最终版本后，您的应用包大小将达到 800 KB 左右，第一次绘制将在 2 秒多的时间内在使用 Angular 9+材质 9 的快速 3G 连接上进行。一个功能齐全的多页应用，利用延迟加载只加载约 300 KB 的依赖项，同时保持不到 2 秒的首次绘制。

请注意，示例应用包含示例代码，可以对其进行裁剪，使应用变得更小。这证明了 Angular 生态系统如何提供丰富和优化的用户体验。

接下来，让我们设置 Angular 材质。

## 安装角材质

有两种方法可以为 Angular app 配置 Angular 材质：

*   自动使用 Angular CLI
*   手动使用 npm

让我们开始这项任务，用 Angular 材质改进天气应用的用户体验。让我们在 GitHub 项目中将**改善应用**任务的用户体验移动到**进行中**。在这里，您可以看到我的看板板的状态：

![](img/B14094_05_05.png)

图 5.5:GitHub 项目看板

### 自动地

从 Angular 6 开始，您可以自动将 Angular 材质添加到您的项目中，节省了大量的时间：

1.  执行`add`命令，如图所示：

    ```ts
    $ npx ng add @angular/material 
    ```

2.  选择名为`indigo-pink`的预构建主题
3.  当您收到提示“`Set up global Angular Material typography styles?`”时，请输入“`no`”
4.  当您收到提示“`Set up browser animations for Angular Material?`”时，请输入“`yes`”
5.  The output should be similar to the following example:

    ```ts
    Installing packages for tooling via npm.
    Installed packages for tooling via npm.
    ? Choose a prebuilt theme name, or "custom" for a custom theme: Indigo/Pink        [ Preview: https://material.angular.io?theme=indigo-pink ]
    ? Set up global Angular Material typography styles? No
    ? Set up browser animations for Angular Material? Yes
    UPDATE package.json (1348 bytes)
    √ Packages installed successfully.
    UPDATE src/app/app.module.ts (423 bytes)
    UPDATE angular.json (3740 bytes)
    UPDATE src/index.html (487 bytes)
    UPDATE src/styles.css (181 bytes) 
    ```

    注意已修改`index.html`文件，添加图标库和默认字体，如下所示：

    ```ts
    **src/index.html**
    <head>
      ...
      <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </head> 
    ```

    `angular.json`文件已更新以设置默认主题：

    ```ts
    **angular.json**
    ...
    "styles": [
      "./node_modules/@angular/material/prebuilt-themes/indigo-pink.css",
      "src/styles.css"
    ],
    ... 
    ```

    `styles.css`已更新为默认全局 CSS 样式：

    ```ts
    **src/styles.css**
    html, 
    body { 
      height: 100%; 
    }
    body { 
      margin: 0; 
      font-family: Roboto, "Helvetica Neue", sans-serif; 
    } 
    ```

    还要注意，`app.module.ts`已更新为导入`BrowserAnimationsModule`，如图所示：

    ```ts
    **src/app/app.module.ts**
    import { BrowserAnimationsModule } from '@angular/platform- browser/animations';
    @NgModule({ 
      declarations: [
        AppComponent
      ],
      imports: [
        ...
        BrowserAnimationsModule
      ], 
    ```

6.  启动应用并确保其正常工作：

    ```ts
    $ npm start 
    ```

这样，你就完了。你的应用应该配置有 Angular 材质。您现在可以跳到*导入模块*部分，了解如何以稳健的方式导入物料模块。

我强烈建议浏览所有手动安装和配置步骤。你知道的越多！

理解构成角材质的各种组件仍然很重要，或者你可能不喜欢自动的东西；在接下来的部分中，我们将介绍手动安装和配置步骤。

### 人工

我们将首先安装所有必需的库。从 Angular 5 开始，Angular Material 的主要版本应与 Angular 安装的版本相匹配，并与 Angular 6 同步：

1.  在终端执行`npm install @angular/material @angular/cdk`
2.  遵守`package.json`版本：

    ```ts
    **package.json**
     "dependencies": { 
        "@angular/cdk": "9.0.0",
        "@angular/material": "9.0.0", 
        ... 
    ```

在这种情况下，所有库都有相同的主版本和次版本。如果您的主要和次要版本不匹配，您可以重新运行`npm install`命令来安装特定版本，或者通过将包的服务器版本附加到`install`命令来选择升级您的 Angular 版本：

```ts
$ npm install @angular/material@9.0.0 @angular/cdk@9.0.0 
```

如果您使用的是类似 Bash 的 shell，那么可以使用括号语法来节省一些输入，以避免重复`npm install @angular/{material,cdk}@9.0.0`形式的部分命令。

如果您需要更新您的 Angular 版本，请参考*附录 C*中的*更新 Angular*部分*保持 Angular 和 Tools Evergreen*。您可以从[在线找到此附录 https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.pdf](https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.) 或在[处 https://expertlysimple.io/stay-evergreen](https://expertlysimple.io/stay-evergreen) 。

## 了解材质的组成部分

让我们看看我们到底在安装什么：

*   `@angular/material`为官方资料库。
*   `@angular/cdk`是一种对等依赖，除非您打算构建自己的组件，否则不能直接使用。
*   `@angular/animations`启用某些材质模块的一些动画。可以省略它以保持应用的最小大小。您可以使用`NoopAnimationsModule`在需要此依赖关系的模块中禁用动画。因此，您将失去 Angular 材质的一些 UX 好处。

## 手动配置 Angular 材质

既然依赖项已经安装，让我们在 Angular 应用中配置 Angular Material。请注意，如果您使用`ng add @angular/material`安装角材质，部分工作将为您完成。

### 导入模块

我们将首先创建一个单独的模块文件，以容纳所有材质模块导入：

1.  Execute the following command in the Terminal to generate `material.module.ts`:

    ```ts
    $ npx ng g m material --flat -m app 
    ```

    注意使用了`--flat`标志，这表示不应为`material.module.ts`创建额外的目录。另外，请注意，指定了`--module`的别名`-m`，以便我们的新模块自动导入`app.module.ts`。

2.  观察新创建的文件`material.module.ts`并删除`CommonModule`：

    ```ts
    **src/app/material.module.ts**
    import { NgModule } from '@angular/core' 
    @NgModule({
      imports: [], 
      declarations: [],
    })
    export class MaterialModule {} 
    ```

3.  确保模块已导入`app.module.ts`：

    ```ts
    **src/app/app.module.ts**
    import { MaterialModule } from './material.module'
    ...
    @NgModule({
      ...
      imports: [..., MaterialModule],
    } 
    ```

4.  添加动画和手势支持（如果未自动添加）：

    ```ts
    **src/app/app.module.ts**
    import { BrowserAnimationsModule } from '@angular/platform-browser/animations'
    @NgModule({
      ...
      imports: [..., MaterialModule, BrowserAnimationsModule],
    } 
    ```

5.  Modify `material.module.ts` to import and export basic components for `MatButton`, `MatToolbar`, and `MatIcon`:

    ```ts
    **src/app/material.module.ts**
    import { NgModule } from '@angular/core'
    import { MatButtonModule } from '@angular/material/button'
    import { MatIconModule } from '@angular/material/icon'
    import { MatToolbarModule } from '@angular/material/toolbar'
    @NgModule({
      imports: [
        MatButtonModule, MatToolbarModule, MatIconModule
      ], 
      exports: [
        MatButtonModule, MatToolbarModule, MatIconModule
      ],
    })
    export class MaterialModule {} 
    ```

    `imports`和`exports`阵列有时会变得很长且重复。如果您在其中一个数组中丢失了一个元素，那么您可能会在几个小时内追踪 bug。考虑将一个数组实现为一个常数，您可以将其分配给 TyrT2 和 Ty3 T3 属性以获得更可靠的配置。谢谢布伦顿·考金斯的提示。

6.  优化你的代码，将你的模块存储在一个数组中，并重用它来导入和导出：

    ```ts
    **src/app/material.module.ts**
    ...
    const modules = 
      [MatButtonModule, MatToolbarModule, MatIconModule]
    @NgModule({
      declarations: [],
      imports: modules,
      exports: modules,
    })
    export class MaterialModule {} 
    ```

材质现在导入到应用中；现在，让我们配置一个主题，并将必要的 CSS 添加到我们的应用中。

### 导入主题

基本主题是使用材质组件所必需的。在安装角材质时，我们已经选择了默认的主题。我们可以在`angular.json`中定义或更改默认主题：

```ts
**angular.json**
...
"styles": [
  {
    "input":
      "node_modules/@angular/material/prebuilt-themes/indigo-pink.css"
  },
  "src/styles.css"
],
... 
```

从此处选择一个新选项：

*   `deeppurple-amber.css`
*   `indigo-pink.css`
*   `pink-bluegrey.css`
*   `purple-green.css`

更新`angular.json`以使用新材质主题。

您也可以创建自己的主题，这将在本章的*自定义主题*部分介绍。欲了解更多信息，请访问[https://material.angular.io/guide/theming](https://material.angular.io/guide/theming) 。

请注意，在`styles.css`中实现的任何 CSS 都将在整个应用中全局可用。也就是说，不要在这个文件中包含特定于视图的 CSS。为此，每个组件都有自己的 CSS 文件。

### 添加材质图标字体

通过将材质图标 web 字体添加到应用中，您可以访问良好的默认图标集。这是一个非常轻量级的库，大小为 48KB。

对于图标支持，请导入`index.html`中的字体：

```ts
**src/index.html**
<head>
  ...
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head> 
```

发现并搜索[处的图标 https://material.io/resources/icons](https://material.io/resources/icons) 。

要获得更丰富的图标集，请访问[materialdesignics.com](http://MaterialDesignIcons.com)。此图标集包含基本的材质图标集，以及一组丰富的第三方图标集，其中包含社交媒体网站上的有用图像，用于覆盖大量地面的丰富动作集。此字体大小为 118 KB。

我们的用于 Angular 材质的 UI/UX 库现在已配置。我们还需要一个布局库，它可以在页面上放置组件时让生活变得更轻松。

接下来，让我们了解不同的布局技术，从引导到 Flexbox CSS，以及为什么 Angular Flex 布局是管理布局的好工具。为我们的应用配置 Angular Flex 布局后，我们将准备在应用中实现材质 UI 组件。

# 角弯曲布局

在有效使用材质之前，必须了解其布局引擎。如果您从事 web 开发已有一段时间，您可能会遇到 Bootstrap 的 12 列布局系统。我发现它非常令人恼火，因为它触犯了我大脑中的一个数学屏障，这个屏障被连接起来，将事物分成 100%的部分。Bootstrap 还要求严格遵守`div`列和行层次结构，必须从顶层 HTML 到底层进行精确管理。这会导致非常令人沮丧的开发体验。

在以下屏幕截图中，您可以看到 Bootstrap 的 12 列方案的外观：

![](img/B14094_05_06.png)

图 5.6:Bootstrap 的 12 列布局方案

Bootstrap 的自定义网格布局系统在当时是革命性的，但随后 CSS3 Flexbox 出现在现场。结合媒体查询，这两种技术允许创建响应性 UI。然而，要有效地利用这些技术是非常困难的。从 Angular v4.1 开始，Angular 团队引入了其灵活的布局系统。

GitHub 上的 Angular Flex 布局文档恰当地解释了以下内容：

> Angular Flex Layout 使用 FlexBox CSS 和 mediaQuery 提供了一个复杂的布局 API。此模块为 Angular（v4.1 及更高版本）开发人员提供组件布局功能，使用自定义布局 API、mediaQuery Observable 和注入的 DOM flexbox-2016 CSS 样式。

Angular 的优秀实现使得 Flexbox 的使用非常简单。正如文件进一步解释的那样：

> 布局引擎智能地自动化了将适当的 FlexBox CSS 应用于浏览器视图层次结构的过程。这种自动化还解决了 Flexbox CSS 的传统、手动、仅 CSS 应用遇到的许多复杂性和解决方法。

该库功能强大，可以容纳您可以想象的任何类型的网格布局，包括与您期望的所有 CSS 功能的集成，例如`calc()`函数。在下图中，您可以看到如何使用 CSS Flexbox 描述列：

![](img/B14094_05_07.png)

图 5.7：Angular 柔性布局方案

好消息是，Angular Flex 布局与 Angular Material 没有任何耦合，可以独立使用。这是一个非常重要的解耦，它解决了将 AngularJS 与 Material v1 一起使用时的一个主要痛点，因为对 Material v1 的版本更新通常会导致布局中出现错误。

有关更多详细信息，请查看[https://github.com/angular/flex-layout/wiki](https://github.com/angular/flex-layout/wiki) 。

你会注意到`@angular/flex-layout`安装了一个 beta 标签。这是这个图书馆长期以来的现状。该库不可能覆盖所有返回到 InternetExplorer11 的边缘案例，这会阻止它退出测试版。然而，在 evergreen 浏览器中，我发现库的行为是可靠和一致的。此外，CSS 网格将取代 CSS Flexbox，因此，该库使用的底层技术可能会发生变化。我的愿望是，这个库充当底层布局引擎的抽象层。

## 响应式布局

您设计和构建的所有 UI 都应该是 mobile first UI。这不仅适用于手机浏览器，也适用于笔记本电脑用户在窗口中与其他应用并排使用您的应用的情况。要让移动第一设计正确，有很多细微差别。

以下是*Mozilla Holy Grail 布局*，它展示了“根据不同屏幕分辨率动态更改布局的能力”，同时优化移动设备的显示内容。

您可以在[上阅读更多关于 Flexbox 的基本概念 https://mzl.la/2vvxj25](https://mzl.la/2vvxj25) 。

这表示 UI 在大屏幕上的外观：

![](img/B14094_05_08.png)

图 5.8：大屏幕上的 Mozilla Holy Grail 布局

相同的布局显示在小屏幕上，如下所示：

![](img/B14094_05_09.png)

图 5.9：小屏幕上的 Mozilla Holy Grail 布局

Mozilla 的参考实现需要 85 行代码才能完成这种响应性 UI。Angular Flex 布局只需一半代码即可完成相同的任务。

## 安装角柔性布局

让我们在我们的项目中安装并添加 Angular Flex 布局：

1.  In the Terminal, execute `npm i @angular/flex-layout`

    要避免对等依赖错误，请执行`npm i @angular/flex-layout@next`或`npm i @angular/flex-layout --force`，如*附录 C*、*保持 Angular 和工具常青*中所述。您可以从[在线找到此附录 https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.pdf](https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.) 或在[处 https://expertlysimple.io/stay-evergreen](https://expertlysimple.io/stay-evergreen) 。

2.  更新`app.module.ts`，如图所示：

    ```ts
    **src/app.module.ts**
    import { FlexLayoutModule } from '@angular/flex-layout'
    imports: [..., **FlexLayoutModule** ], 
    ```

安装了 Flex Layout 之后，让我们介绍一下库的基本工作原理。

## 布局基础

引导和 CSS Flexbox 与 Angular Flex 布局不同。如果你学习 Angular Flex 布局，你会发现自己使用的布局代码要少得多，因为 Angular Material 在大多数情况下都会自动做正确的事情，但是，一旦你意识到一旦你离开 Angular Flex 布局的保护茧，你必须编写更多的代码才能让事情正常工作，你就会失望。但是，由于概念基本相同，因此您的技能仍然会转换。

让我们在下面几节中回顾一下 Flex 布局 API。

如果你是 CSS 甚至 Flexbox 的新手，使用的一些缩写可能没有意义。我建议您试用文档中提供的 live demo 应用，以便在更直观的层面上更好地了解库的功能。欲了解更多信息和现场演示链接，请访问[https://github.com/angular/flex-layout/wiki/Declarative-API-Overview](https://github.com/angular/flex-layout/wiki/Declarative-API-Overview) 。

### DOM 容器的 Flex 布局 API

这些指令可用于 DOM 容器，如`<div>`或`<span>`来操纵的布局方向、对齐方式或元素之间的间隙。

考虑下面的例子：

```ts
<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="15px">...</div> 
```

`div`被布置为一行，因此多个`div`将呈现在彼此的顶部，而不是一列布局，它们将呈现在彼此的旁边。

`div`在其父容器内水平左对齐并垂直居中对齐。

`div`在其周围元件之间有 15 像素的间隙。

考虑下面的图表来映射空间中的术语：

![css3-flexbox-model](img/B14094_05_10.jpg)

图 5.10：Angular 柔性布局术语的空间映射

下表列出了完整的选项列表：

<colgroup><col> <col></colgroup> 
| **HTML API** | **允许值** |
| `fxLayout` | `<direction>``<direction> <wrap>`用途：行&#124;列&#124;行反转&#124;列反转 |
| `fxLayoutAlign` | `<main-axis> <cross-axis>``main-axis`：开始&#124;中心&#124;结束&#124;周围空间&#124;中间空间`cross-axis`：开始&#124;中间&#124;结束&#124;伸展 |
| `fxLayoutGap` | %&#124; px &#124;大众&#124; vh |

### DOM 元素的 Flex 布局 API

这些指令影响 DOM 元素在其容器中的行为。

考虑下面的例子：

```ts
<div fxLayout="column">
  <input fxFlex />
</div> 
```

`input`元素将增长以填充父`div`提供的所有可用空间。如果将`fxFlex`设置为`fxFlex="50%"`，则只会占用一半的可用空间。在这种情况下，`fxFlexAlign`属性可用于在`div`内左对齐、右对齐或居中对齐元素。

下表列出了完整的选项列表：

<colgroup><col> <col></colgroup> 
| **HTML API** | **允许值** |
| `fxFlex` | “&#124; px &#124;%&#124;大众&#124; vh &#124;`<grow> <shrink> <basis>` |
| `fxFlexOrder` | `int` |
| `fxFlexOffset` | %&#124; px &#124;大众&#124; vh |
| `fxFlexAlign` | 开始&#124;基线&#124;中心&#124;结束 |
| `fxFlexFill` | 没有一个 |



### 任何元素的 Flex 布局 API

以下指令可应用于任何 HTML 元素，以显示、隐藏或更改这些元素的外观。

考虑下面的例子：

```ts
<div fxShow fxHide.lt-sm></div> 
```

默认设置为`true`的`fxShow`将显示`div`元素。除非`lt-sm`条件变为`true`，当浏览器窗口缩小到*小*阈值以下时会发生这种情况。*小*定义为 468 像素的像素值。因此，如果浏览器窗口的宽度缩小到 467 像素或更小，`fxHide`将隐藏`div`元素。

下表列出了完整的选项列表：

<colgroup><col> <col></colgroup> 
| **HTML API** | **允许值** |
| `fxHide` | 真&#124;假&#124; 0 &#124;” |
| `fxShow` | 真&#124;假&#124; 0 &#124;” |
| `ngClass` | `@extends ngClass core` |
| `ngStyle` | `@extends ngStyle core` |

本节介绍静态布局的基础知识。有关静态 API 的更多信息，请访问[https://github.com/angular/flex-layout/wiki/Declarative-API-Overview](https://github.com/angular/flex-layout/wiki/Declarative-API-Overview) 。我们将在*第 11 章*、*秘籍*中介绍响应 API—可重用性、路由和缓存。您可以在[上阅读更多关于响应 API 的信息 https://github.com/angular/flex-layout/wiki/Responsive-API](https://github.com/angular/flex-layout/wiki/Responsive-API) 。

现在我们的布局引擎已经配置好，您对它的工作原理有了初步的了解，我们可以开始为我们的应用构建屏幕了。

# 使用材质组件

现在我们已经安装了所有不同的依赖项，我们可以开始修改 Angular 应用来添加材质组件。我们将添加一个工具栏和一个材质设计卡元素，并涵盖可访问性和排版问题以及基本的布局技术。

## 角材质示意图

自从 Angular 6 和 schematics 的引入，Material 之类的库可以提供自己的代码生成器。出版时，Angular Material 附带了三个基本生成器，用于创建带有侧导航、仪表板布局或数据表的 Angular 组件。有关发电机示意图的更多信息，请参见[https://material.angular.io/guide/schematics](https://material.angular.io/guide/schematics) 。

例如，可以通过执行以下命令创建侧导航布局：

```ts
$ ng generate @angular/material:material-nav --name=side-nav
CREATE src/app/side-nav/side-nav.component.css (110 bytes) CREATE src/app/side-nav/side-nav.component.html (945 bytes) CREATE src/app/side-nav/side-nav.component.spec.ts (619 bytes) CREATE src/app/side-nav/side-nav.component.ts (489 bytes) UPDATE src/app/app.module.ts (882 bytes) 
```

此命令更新了`app.module.ts`，直接将材质模块导入该文件，打破了我先前建议的`material.module.ts`模式。此外，一个新的`SideNavComponent`作为一个单独的组件添加到应用中，但正如*第 8 章*中的*侧导航*部分所述，*设计认证和授权*，这样的导航体验需要在应用的根本上实现。

简言之，Angular Material Schematics 使得在 Angular 应用中添加各种材质模块和组件的麻烦小得多；然而，正如所提供的，这些示意图不适合创建灵活、可伸缩和结构良好的代码库，这是本书追求的目标。

目前，我建议将这些示意图用于快速原型或实验目的。

现在，让我们开始手动向 LocalCast 天气应用添加一些组件。

## 使用“材质”工具栏修改登录页

在我们开始对`app.component.ts`进行进一步更改之前，让我们将组件切换为使用内联模板和内联样式，这样我们就不必为一个相对简单的组件在文件之间来回切换：

1.  更新`app.component.ts`以使用内联模板。将`app.component.html`的内容剪切粘贴到`app.component.ts`上，移除`styleUrls`属性，如下图：

    ```ts
    **src/app/app.component.ts**
    import { Component } from '@angular/core'
    @Component({
      selector: 'app-root', 
     **template: `**
        <div style="text-align:center">
          <h1>
            LocalCast Weather
          </h1>
          <div>Your city, your forecast, right now!</div>
          <h2>Current Weather</h2>
          <app-current-weather></app-current-weather>
        </div>
      **`,**
    })
    export class AppComponent {} 
    ```

2.  删除文件`app.component.html`和`app.component.css`。
3.  让我们开始通过实现应用范围的工具栏来改进我们的应用。观察`app.component.ts`：

    ```ts
    **src/app/app.component.ts**
    <h1>
      LocalCast Weather
    </h1> 
    ```

    中的`h1`标签
4.  将`h1`标签更新为`mat-toolbar`：

    ```ts
    **src/app/app.component.ts**
    **<mat-toolbar>**
      <span>LocalCast Weather</span>
    **</mat-toolbar>** 
    ```

5.  用更引人注目的颜色更新`mat-toolbar`：

    ```ts
    **src/app/app.component.ts**
    <mat-toolbar **color="primary"**> 
    ```

请注意，如果您没有按照前面章节*导入模块*中的说明导入`MatToolbarModule`，您的应用将无法编译。

请注意，材质将以下样式添加为全局样式：

```ts
**src/styles.css**
body {
  margin: 0;
} 
```

有一个`0`边距提供了一种本地应用的感觉，工具栏接触到浏览器的边缘。这在大屏幕和小屏幕格式上都能很好地工作。当您将可点击的元素（如汉堡菜单或帮助按钮）放置在工具栏的最左侧或最右侧时，您将避免用户点击空白区域的可能性。这就是为什么材质按钮的点击区域实际上比视觉显示的要大。这在制作无挫折的 UX 方面有很大的不同。

同样，如果您正在构建一个信息密集型应用，请注意，您的内容会一直延伸到应用的边缘，使您的内容更难阅读，这不是一个理想的结果。在这些情况下，您应该将内容区域包装在`div`中，并使用 CSS 应用适当的边距，如下所示：

```ts
**example**
.content-margin { 
  margin-left: 8px; 
  margin-right: 8px;
} 
```

在下一个屏幕截图中，您可以看到应用了原色的边到边工具栏：

![](img/B14094_05_11.png)

图 5.11：改进工具栏的 LocalCast 天气

现在我们配置好了工具栏，让我们继续制作一个天气信息容器。

## 材质卡片

材质卡片是表示当前天气信息的一个很好的容器。卡片元素被一个阴影所包围，阴影从其周围描绘出内容：

1.  在`material.module`

    ```ts
    **src/app/material.module.ts**
    import { MatCardModule } from '@angular/material/card'
    ...
    const modules = […, MatCardModule] 
    ```

    中导入`MatCardModule`
2.  在 AppComponent 的模板中，用`<mat-card>`：

    ```ts
    **src/app/app.component.ts**
    ...
      template: `
      ...
      <div style="text-align:center">
        <mat-toolbar color="primary">
          <span>LocalCast Weather</span>
        </mat-toolbar>
        <div>Your city, your forecast, right now!</div>
        **<mat-card>**
          <h2>Current Weather</h2>
          <app-current-weather></app-current-weather>
        **</mat-card>**
      </div>
      ...
      `,
    ... 
    ```

    环绕`<app-current-weather>`
3.  Observe the barely distinguishable card element with its shadow near the bottom of the screen below:

    ![](img/B14094_05_12.png)

    图 5.12：具有不可区分卡片元素的 LocalCast 天气

    为了更好地布局屏幕，我们需要切换到 Flex 布局引擎。我们将首先从组件模板中删除训练控制盘。

4.  从最外层的`<div>`元件上拆下`style="text-align:center"`。
5.  Surround `<mat-card>` with the following HTML, where the contents of `<mat-card>` replaces the ellipses in the middle of the code:

    要居中页面中的一个元素，我们需要创建一行，为居中元素指定一个宽度，并在任意一侧创建两个额外的列，可以调整以占用空白，例如：

    ```ts
    **src/app/app.component.ts**
    ...
    <div fxLayout="row">
      <div fxFlex></div>
      <div fxFlex="300px">
          **...**
      </div>
      <div fxFlex></div>
    </div>
    ... 
    ```

1.  观察`mat-card`元件是否正确居中，如下所示：

![](img/B14094_05_13.png)

图 5.13：带中心卡的 LocalCast 天气

阅读卡片文档，并在[的文档网站上浏览示例 https://material.angular.io/components/card/overview](https://material.angular.io/components/card/overview) ，您会注意到`mat-card`提供了一些元素来存放标题和内容。我们将在接下来的章节中实现这一点。

在`material.angular.io`上，您可以通过点击括号图标查看任何示例的源代码，或者通过点击箭头图标在[StackBlitz.io](http://StackBlitz.io)中启动一个工作示例。

### 卡片标题和内容

现在，让我们用`mat-card-header`和`mat-card-content`实现`mat-card`的标题和内容元素，如图所示：

```ts
**src/app/app.component.ts**
...
<mat-toolbar color="primary">
  <span>LocalCast Weather</span>
</mat-toolbar>
<div>Your city, your forecast, right now!</div>
<div fxLayout="row">
  <div fxFlex></div>
  <div fxFlex="300px">
    <mat-card>
      **<mat-card-header>**
 **<mat-card-title>Current Weather</mat-card-title>**
 **</mat-card-header>**
 **<mat-card-content>**
 **<app-current-weather></app-current-weather>**
 **</mat-card-content>**
    </mat-card>
  </div>
  <div fxFlex></div>
</div>
... 
```

所有材质元素都支持 Flex 布局引擎。这允许我们优化 HTML，并将`<div fxFlex="300px">`与`<mat-card>`合并，简化代码：

```ts
**src/app/app.component.ts**
...
<div fxLayout="row">
  <div fxFlex></div>
  **<mat-card fxFlex="300px">**
    ...
  </mat-card>
  <div fxFlex></div>
</div>
... 
```

这对于复杂 UI 中的可维护性具有巨大的积极意义。

**别忘了**：有了材质，少就是多。

在我们应用`mat-card-header`和`mat-card-content`之后，您可以看到这个结果：

![](img/B14094_05_14.png)

图 5.14：带有标题和内容的 LocalCast 天气卡

请注意，卡中的字体现在与材质的 Roboto 字体匹配。然而，**当前天气**不再像以前那样引人注目。如果您在`mat-card-title`内的`h2`标签中加回，**当前天气**在视觉上看起来会更大；但是，字体与应用的其余部分不匹配。要解决此问题，您必须了解材质的排版功能。

## 材质排版

材质的文件恰当地说明如下：

> 排版是一种排版方式，使文本在显示时清晰易读，富有吸引力。

Material 提供了不同级别的排版，具有不同的`font-size`、`line-height`和`font-weight`特征，可以应用于任何 HTML 元素，而不仅仅是现成提供的组件。

下表中是可用于应用材质排版的 CSS 类。

考虑下面的例子：

```ts
<div class="mat-display-4">Hello, Material world!</div> 
```

`display-4`排版通过在`div`前面加上“`mat-`来应用于它。

有关印刷样式的完整列表，请参见下表：

<colgroup><col> <col></colgroup> 
| **类名** | **用法** |
| `display-4`、`display-3`、`display-2`和`display-1` | 大型一次性标题，通常位于页面顶部（例如，英雄标题） |
| `h1`、`headline` | `<h1>`标签对应的章节标题 |
| `h2`、`title` | `<h2>`标签对应的章节标题 |
| `h3`、`subheading-2` | `<h3>`标签对应的章节标题 |
| `h4`、`subheading-1` | `<h4>`标签对应的章节标题 |
| `body-1` | 基本正文文本 |
| `body-2` | 粗体文本 |
| `Caption` | 较小的正文和提示文本 |
| `Button` | 按钮和锚 |

您可以在[阅读更多关于材质排版的信息 https://material.angular.io/guide/typography](https://material.angular.io/guide/typography) 。

### 应用排版

有多种方式应用排版。一种方法是利用`mat-typography`类并使用相应的 HTML 标记，如`<h2>`：

```ts
**example**
<mat-card-header class="mat-typography">
<mat-card-title><h2>Current Weather</h2></mat-card-title>
</mat-card-header> 
```

另一种方法是直接在元素上应用特定的排版，如`class="mat-title"`：

```ts
**example**
<mat-card-title>
  <div class="mat-title">Current Weather</div>
</mat-card-title> 
```

注意，`class="mat-title"`可以应用于`div`、`span`或`h2`，结果相同。

根据经验，通常最好实现更具体、更本地化的选项，这是这里的第二个实现。

当我们在接下来的章节中实现材质排版时，我们需要确保卡片标题从屏幕上的其他元素中脱颖而出。在这种情况下，我更喜欢`mat-headline`排版的外观来实现这一目标，因此您的实现应该如下所示：

```ts
**src/app/app.component.ts**
<mat-card-title>
  <div **class="mat-headline"**>Current Weather</div>
</mat-card-title> 
```

接下来，让我们看看如何对齐屏幕上的其他元素。

## 柔性布局对齐

我们可以使用`fxLayoutAlign`将应用的标语居中，并使用`mat-caption`排版给它一个柔和的外观：

1.  使用`fxLayoutAlign`：

    ```ts
    **src/app/app.component.ts**
    **<div fxLayoutAlign="center">**
      <div>
        Your city, your forecast, right now!
      </div>
    **</div>** 
    ```

    将包含标语的`div`居中
2.  将`mat-caption`字体应用于标语：

    ```ts
    **src/app/app.component.ts**
    <div **class="mat-caption"**>
      Your city, your forecast, right now!
    </div> 
    ```

3.  观察结果，如下图：

![](img/B14094_05_15.png)

图 5.15：带有居中标语的 LocalCast 天气

接下来，我们需要对元素进行布局以匹配设计。

## 柔性布局

要使 UI 看起来像设计一样，还有很多工作要做。请遵守当前气象卡的以下设计：

![](img/B14094_05_16.png)

图 5.16：当前天气的低保真设计

为了设计布局，我们将利用 Angular Flex。

您将编辑`current-weather.component.html`，它使用`<div>`和`<span>`标记分别建立位于单独行或同一行上的元素。切换到 Angular Flex 后，我们需要将所有元素切换到`<div>`，并使用`fxLayout`指定行和列。

### 实现布局 scaffolding

我们需要从实施粗略的脚手架开始。考虑模板的当前状态：

```ts
**src/app/current-weather/current-weather.component.html**
 **1**  <div *ngIf="!current">
 **2**    no data
 **3**  </div>
 **4**  <div *ngIf="current">
 **5**    <div>
 **6**      <span>{{current.city}}, {{current.country}}</span>
 **7**      <span>{{current.date | date:'fullDate'}}</span>
 **8**    </div>
 **9**    <div>
**10**      <img [src]='current.image'>
**11**      <span>{{current.temperature | number:'1.0-0'}}˚F</span>
**12**    </div>
**13**    <div>
**14**      {{current.description}}
**15**    </div>
**16**  </div> 
```

让我们一步一步地浏览文件并更新它。首先，让我们进行结构更改以支持 Flex 布局：

1.  在第 6、7 和 11 行中，将`<span>`元素更新为`<div>`元素。
2.  在第 10 行，用一个`<div>`元素包裹`<img>`元素。
3.  在第 5 行和第 9 行，将`fxLayout="row"`属性添加到具有多个子元素的外部`<div>`元素。

接下来，将`fxFlex`属性应用于`div`元素，以确定元素应该占用多少水平空间：

1.  在第 6 行中，城市和国家列应占据屏幕的大约 2/3，因此将`fxFlex="66%"`添加到`<div>`元素中。
2.  在第 7 行，将`fxFlex`添加到`<div>`元素中，以确保它填充了剩余的水平空间。
3.  在第 10 行，将`fxFlex="66%"`添加到新的`<div>`元素中，在`<img>`元素周围。
4.  在第 11 行，将`fxFlex`添加到`<div>`元素。

模板的最终状态应如下所示：

```ts
**src/app/current-weather/current-weather.component.html**
 **5**    <div fxLayout="row">
 **6**      **<div fxFlex="66%">**{{current.city}}, ...**</div>**
 **7**      **<div fxFlex>**{{current.date | date:'fullDate'}}**</div>**
 **8**    </div>
 **9**    <div **fxLayout="row"**>
**10**      **<div fxFlex="66%">**<img [src]='current.image'>**</div>**
**11**      **<div fxFlex>**{{current.temperature | number:'1.0-0'}}˚F**</div>**
**12**    </div>
**13**    <div>
**14**      {{current.description}}
**15**    </div> 
```

您可以更详细地添加 Angular Flex 属性；然而，编写的代码越多，需要维护的代码就越多，这使得将来的更改更加困难。例如，在第 13 行，`<div>`元素不需要`fxLayout="row"`，因为`<div>`隐式地获取新行。类似地，在第 7 行和第 11 行，右边的列不需要显式的`fxFlex`属性，因为左边的元素会自动挤压它。然而，我们将保留这些`fxFlex`属性。

从网格放置的 Angular 来看，您的所有元素现在都位于正确的*单元格*中，如下所示：

![](img/B14094_05_17.png)

图 5.17：带脚手架布局的局部浇筑天气

随着响应性设计的实施，接下来，让我们研究主要元素的对齐。

## 用 CSS 对齐元素

现在，我们需要对每个单元格进行对齐和样式设置，以匹配设计。为此，我们在`fxLayoutAlign`上依赖 CSS。日期和温度需要右对齐，描述居中：

1.  要右对齐日期和温度，请在`current-weather.component.css`：

    ```ts
    **src/app/current-weather/current-weather.component.css**
    .right {
      text-align: right
    } 
    ```

    中创建一个名为`.right`的新 CSS 类
2.  在第 7 行和第 11 行的`<div>`元素中添加`class="right"`。
3.  将描述的`<div>`元素居中，就像在本章前面将应用的标语居中一样。使用具有`fxLayoutAlign="center"`属性的周围`div`。

1.  观察各元件是否正确对齐，如下所示：

![](img/B14094_05_18.png)

图 18:LocalCast 与天气的正确对齐

在对齐主要元素后，让我们将第一层样式应用于每个元素，以匹配设计。

### 单独设置样式元素

最终确定元素的样式通常是前端开发中最耗时的部分。我建议您先进行多次测试，以尽可能少的努力获得足够接近的设计版本，然后让您的客户或团队决定是否值得花费更多的资源来改进设计：

1.  添加新的 CSS 属性：

    ```ts
    **src/app/current-weather/current-weather.component.css**
    .no-margin { 
      margin-bottom: 0
    } 
    ```

2.  对于城市名称，添加`class="mat-title no-margin"`。
3.  对于日期，将`"mat-h3 no-margin"`添加到`class="right"`。
4.  将日期的显示格式从`'fullDate'`更改为`'EEEE MMM d'`，使之与设计相符。
5.  修改`<img>`增加`style="zoom: 175%"`。
6.  对于温度，在`class="right"`中添加`"mat-display-3 no-margin"`。
7.  For the description, add `class="mat-caption"`.

    这是模板的最终状态：

    ```ts
    **src/app/current-weather/current-weather.component.html**
    <div *ngIf="!current">
      no data
    </div>
    <div *ngIf="current">
      <div fxLayout="row">
        <div fxFlex="66%" class="mat-title no-margin">
          {{current.city}}, {{current.country}}
        </div>
        <div fxFlex class="right mat-h3 no-margin">
          {{current.date | date:'EEEE MMM d'}}
        </div>
      </div>
      <div fxLayout="row">
        <div fxFlex="66%">
          <img style="zoom: 175%" [src]='current.image'>
        </div>
        <div fxFlex class="right mat-display-3 no-margin">
        {{current.temperature | number:'1.0-0'}}˚F
      </div>
    </div>
      <div fxLayoutAlign="center">
        <div class="mat-caption">
          {{current.description}}
        </div>
      </div>
    </div> 
    ```

8.  Observe that the styled output of your code changes, as illustrated:

    ![](img/B14094_05_19.png)

    图 5.19：带有样式的 LocalCast 天气

我们已经为我们的设计添加了第一层样式。接下来，让我们微调元素的间距和对齐方式。

### 微调风格

标语可以从一些顶部和底部边缘获益。这是我们可能在整个应用中使用的常见 CSS，因此我们将其放在`styles.css`中：

1.  在全球实施`vertical-margin``styles.css`：

    ```ts
    **src/styles.css**
    .vertical-margin { 
      margin-top: 16px; 
      margin-bottom: 16px;
    } 
    ```

2.  在`app.component.ts`中，将`vertical-margin`应用于应用的标语：

    ```ts
    **src/app/app.component.ts**
    <div class="mat-caption **vertical-margin**">
      Your city, your forecast, right now!
    </div> 
    ```

3.  在`current-weather.component.html`中，图像和温度没有居中，因此在围绕这些元素的外部`div`中添加`fxLayoutAlign="center center"`：

    ```ts
    **src/app/current-weather/current-weather.component.html**
    <div fxLayout="row" **fxLayoutAlign="center center**">
      ...
    </div> 
    ```

4.  Observe the finalized layout of your app, which should look like this:

    ![](img/B14094_05_20.png)

    图 5.20:LocalCast 天气最终布局

最后，让我们通过收紧我们的设计来增加更多的视觉效果，比如修复白天和月份之间缺少的换行符，并添加一些很好的特性。

### 调整以匹配设计

这是一个你可能会花费大量时间的区域。如果我们遵循 80-20 原则，那么像素完美的调整通常是最后 20%，需要 80%的时间才能完成。让我们检查一下上图中的实现与下图中所示的原始设计之间的差异，以及如何弥合这一差距：

![](img/B14094_05_21.png)

图 5.21:LocalCast 天气原始设计

日期需要进一步定制。我们的实现中缺少数字序号*th*；为此，我们需要引入第三方库，如`moment`或实施我们自己的解决方案，并将其绑定到模板上的日期旁边：

1.  在`CurrentWeatherComponent`：

    ```ts
    **src/app/current-weather/current-weather.component.ts**
    export class CurrentWeatherComponent implements OnInit {
      ...
      getOrdinal(date: number) {
        const n = new Date(date).getDate()
        return n > 0
          ? ['th', 'st', 'nd', 'rd'][(n > 3 && n < 21) || 
                                      n % 10 > 3 ? 0 : n % 10]
          : ''
      }
      ...
    } 
    ```

    中实现`getOrdinal`功能
2.  In the template, update `current.date` to append an ordinal to it:

    ```ts
    **src/app/current-weather/current-weather.component.html**
    <div fxFlex class="right mat-h3 no-margin">
      {{current.date | 
        date:'EEEE MMM d'}}**{{getOrdinal(current.date)}}**
    </div> 
    ```

    请注意，`getOrdinal`的实现归结为一个复杂的单行程序，它不是非常可读，并且很难维护。如果这些功能对您的业务逻辑至关重要，那么它们应该经过大量的单元测试。

    接下来，让我们修复一周中的一天和一个月之间缺少的换行符。在某些日子，如 3 月 23 日<sup>路</sup>周一，周一和三月将在第一条线上，而 23<sup>路</sup>将单独在第二条线上。然而，在 3 月 24 日<sup>日</sup>周二，该问题不存在，3 月和 24 日<sup>日</sup>属于同一条线。Angular 在发布时不支持日期模板中的换行符；理想情况下，我们应该能够将日期格式指定为“EEEE\nMMM d”，以确保换行符始终一致。然而，我们可以在这个问题上抛出一些低效的代码，并强制执行我们想要的行为。

3.  Break up the current date into two parts and separate them with the line break tag `<br>`, then remove the class right from the outer `div`:

    ```ts
    **src/app/current-weather/current-weather.component.html**
    <div fxFlex class="mat-h3 no-margin">
      {{current.date | date:'EEEE'}}<br>
      {{current.date | date:'MMM d'}}{{getOrdinal(current.date)}}
    </div> 
    ```

    切勿将`<br>`用于布局目的。在这种有限的情况下，这是可以接受的，因为我们正在分解一个`div`或`p`标记中的内容。

    现在，让我们在显示温度单位时添加一些视觉效果。为了实现这一点，温度实现需要用一个`<span>`元素将数字与单元分开，并用一个`<p>`元素包围，这样就可以沿着`<span class="unit">``˚``F</span>`的线条将上标样式应用于单元，其中`unit`是一个 CSS 类，使其内容看起来像上标元素。

4.  实现一个`unit`CSS 类：

    ```ts
    **src/app/current-weather/current-weather.component.css**
    .unit {
    vertical-align: super;
    } 
    ```

5.  将图像上的弯曲度降低至 55%，用`p`标签包裹温度和装置，并在`p`标签上涂抹`mat-display-3`。然后在带有`p`标签的温度单元周围实施`span`，并将`unit`和`mat-display-1`类应用于`span`：

    ```ts
    **src/app/current-weather/current-weather.component.html**
    <div fxFlex=**"55%"**>
      <img style="zoom: 175%" [src]='current.image'>
    </div>
    <div fxFlex class="right no-margin">
      **<p class="mat-display-3">**
        {{current.temperature | number:'1.0-0'}}
        **<span class="mat-display-1 unit">**˚F**</span>**
      **</p>**
    </div> 
    ```

您通常需要通过调整前面第一行上的`fxFlex`值来试验预测图像应该有多少空间。如果占用太多空间，温度会溢出到下一行。浏览器窗口的大小会进一步影响您的设置。60%似乎效果不错，但当我编写此样本时，当前天气为 55˚F，因此出于完全诗意的原因，我决定使用 55%。请在此处查看我们应用的精美版本：

![](img/B14094_05_22.png)

图 5.22：调整后的 LocalCast 天气

一如既往，可以进一步调整边距和填充物，以进一步定制设计。但是，每个与库的偏差都会带来可维护性的后果。除非您真的在围绕显示天气数据建立业务，否则您应该将任何进一步的优化推迟到项目结束时，如果时间允许，并且经验可以作为指导，那么您将不会进行此优化。

有了两个负边距的底部破解，您可以获得一个与原始设计相当接近的设计，但我不会在这里包括这些破解，而是让读者在 GitHub 存储库中发现。这种黑客行为有时是必要的，但总的来说，它们指出了设计和实现现实之间的脱节。通向“调整”部分的解决方案是最佳点，在该点，角材质蓬勃发展。除此之外，你可能是在浪费时间。我继续为你浪费时间，结果如下：

![](img/B14094_05_23.png)

图 5.23：调整和破解后的 LocalCast 天气

现在，我们的布局和设计已经很好了，让我们看看如何使用角材质创建自定义主题。

## 自定义主题

如前所述，材质附带一些默认主题，包括`deeppurple-amber`、`indigo-pink`、`pink-blue-grey`和`purple-green`。但是，您的公司或产品可能有自己的配色方案。为此，您可以创建一个自定义主题来更改应用的外观。

要创建新主题，必须实现新的 SCSS 文件：

1.  从`angular.json`中删除默认主题的所有定义。
2.  重新运行命令`npx ng add @angular/material`。
3.  这次选择`Custom`作为主题。
4.  运行命令后，确保您的`index.html`和`styles.css`文件未被修改。如果是，请还原更改。
5.  This will create a new file under `src` called `custom-theme.scss.` Rename it to `localcast-theme.scss`, shown as follows:

    ```ts
    **src/localcast-theme.scss**
    // Custom Theming for Angular Material
    // For more information: https://material.angular.io/guide/theming
    @import '~@angular/material/theming';
    // Plus imports for other components in your app.
    // Include the common styles for Angular Material.
    // We include this here so that you only have to
    // load a single css file for Angular Material in your app.
    // Be sure that you only ever include this mixin once!
    @include mat-core();
    // Define the palettes for your theme using
    // the Material Design palettes available in palette.scss
    // (imported above). For each palette, you can optionally
    // specify a default, lighter, and darker hue.
    // Available color palettes: https://material.io/design/color/
    $local-weather-app-primary: mat-palette($mat-indigo);
    $local-weather-app-accent: mat-palette(
      $mat-pink,
      A200, A100, A400
    );
    // The warn palette is optional (defaults to red).
    $local-weather-app-warn: mat-palette($mat-red);
    // Create the theme object (a Sass map containing
    // all of the palettes).
    $local-weather-app-theme: mat-light-theme(
      $local-weather-app-primary,
      $local-weather-app-accent,
      $local-weather-app-warn
    );
    // Custom Theming for Angular Material
    // For more information: https://material.angular.io/guide/theming
    @import '~@angular/material/theming';
    // Plus imports for other components in your app.
    // Include the common styles for Angular Material.
    // We include this here so that you only have to
    // load a single css file for Angular Material in your app.
    // Be sure that you only ever include this mixin once!
    @include mat-core();
    // Define the palettes for your theme using
    // the Material Design palettes available in palette.scss
    // (imported above). For each palette, you can optionally
    // specify a default, lighter, and darker hue.
    // Available color palettes: https://material.io/design/color/
    $local-weather-app-primary: mat-palette($mat-indigo);
    $local-weather-app-accent: mat-palette($mat-pink, A200, A100, A400);
    // The warn palette is optional (defaults to red).
    $local-weather-app-warn: mat-palette($mat-red);
    // Create the theme object (a Sass map containing
    // all of the palettes).
    $local-weather-app-theme: mat-light-theme(
      $local-weather-app-primary,
      $local-weather-app-accent,
      $local-weather-app-warn
    );
    // Include theme styles for core and each component used in
    // your app. Alternatively, you can import and @include the
    // theme mixins for each component that you are using.
    @include angular-material-theme($local-weather-app-theme); 
    ```

    您可以在[找到材质主题指南 https://material.angular.io/guide/theming](https://material.angular.io/guide/theming) 了解更多详细信息。

    注意`mat-core()`只应在您的申请中包含一次；否则，您将在应用中引入不必要和重复的 CSS 有效负载。

    `mat-core()`包含必要的 SCSS 功能，能够将您自定义的颜色注入到材质中，如`mat-palette`、`mat-light-theme`和`mat-dark-theme`。

    至少，我们必须定义新的主色和强调色。然而，定义新颜色并不是一个简单的过程。材质需要通过`mat-palette`定义调色板，调色板需要由复杂的颜色对象进行播种，而该颜色对象不能被简单的十六进制值（如`#BFB900`覆盖）。

    要选择您的颜色，您可以使用位于[的材质设计颜色工具 https://material.io/resources/color](https://material.io/resources/color) 。以下是该工具的屏幕截图：

    ![](img/B14094_05_24.png)

    图 5.24:Material.io 颜色工具

6.  使用**材质调色板**选择**主**和**次**颜色：
    *   我的主要选择是红色，色调值为`500`。
    *   我的第二个选择是靛蓝，色调值为`A400`。
7.  通过查看页面左侧的六个预构建屏幕，观察您的选择将如何应用于材质设计应用。
8.  Evaluate the accessibility implications of your selections, as shown:

    ![](img/B14094_05_25.png)

    图 5.25:Material.io 颜色工具可访问性选项卡

    该工具警告我们，当在原色上使用白色文本时，我们的选择会导致难以辨认的文本。您应该注意避免在原色上显示白色文本，或者更改选择。

    如果您希望创建自己的调色板，`mat-palette`的界面如下所示：

    ```ts
    mat-palette($base-palette, $default: 500, $lighter: 100, $darker: 700) 
    ```

9.  使用工具

    ```ts
    **src/localcast-theme.scss**
    $local-weather-app-primary: mat-palette($mat-red, 500);
    $local-weather-app-accent: mat-palette($mat-indigo, A400); 
    ```

    中的默认色调定义主要和次要`mat-palette`对象

即使您的主题在 SCS 中，您也可以在应用的其余部分继续使用 CSS。Angular CLI 支持编译 SCS 和 CSS。如果您想更改默认行为，您可以通过将`angular.json`文件中的`defaults.styleExt`属性从 CSS 更改为 SCSS 来完全切换到 SCSS。

您也可以选择删除`styles.css`并将其内容与`localcast-theme.scss`合并，或者通过将`styles.css`重命名为`styles.scss`将其转换为 SASS 文件。如果您这样做，请不要忘记更新`angular.json`。

祝贺您的申请现在应带有您的商标颜色方案：

![](img/B14094_05_26.png)

图 5.26：具有自定义主题的 LocalCast 天气

将代码推送到 GitHub 并查看 CircleCI 管道。

## 用材质进行单元测试

提交代码后，您将注意到，由于测试失败，管道现在正在失败。为了保持单元测试运行，您需要将`MaterialModule`导入任何使用 Angular 材质的组件`spec`文件：

```ts
***.component.spec.ts**
...
  beforeEach(async(() => {
    TestBed.configureTestingModule({
      ...
      imports: [..., MaterialModule],
    }).compileComponents()
  })
) 
```

您还需要更新搜索特定 HTML 元素的任何测试，包括 e2e 测试。

例如，由于应用的标题 LocalCast Weather 不再位于`h1`标记中，因此您必须更新`spec`文件以在`span`元素中查找它：

```ts
**src/app/app.component.spec.ts**
expect(compiled.querySelector('**span**').textContent).toContain('LocalCast Weather') 
```

另一个例子是在`CurrentWeather`组件中，`city`的周围元素不再是`span`，因此您可以使用`mat-title`CSS 类：

```ts
**src/app/current-weather/current-weather.component.spec.ts**
import { By } from '@angular/platform-browser'
// Assert on DOM
const debugEl = fixture.debugElement
const titleEl: HTMLElement =
  debugEl.query(By.css('**.mat-title**')).nativeElement
expect(titleEl.textContent).toContain('Bethesda') 
```

类似地，在 e2e 测试中，您需要更新页面对象函数以从正确位置检索文本：

```ts
**src/e2e/app.po.ts**
getParagraphText() {
  return element(by.css('app-root mat-toolbar span'))
    .getText() as Promise<string>
} 
```

测试通过后，再次将代码推送到 GitHub。当 CircleCI 管道成功后，立即使用 Vercel 发布应用。记住，如果你不发货，它就永远不会发生！

我们现在可以将 UX 任务移动到**完成**列：

![](img/B14094_05_27.png)

图 5.27:GitHub 项目看板状态

在*第 7 章**创建路由一线业务应用*中，您将了解更复杂的工具，以便能够进一步定制材质主题的外观和感觉，创造出符合您所代表品牌的真正独特体验。

# 可达性

注意应用的潜在可访问性问题非常重要。您可以通过访问 A11Y 项目网站[了解无障碍问题 https://a11yproject.com](https://a11yproject.com) 。材质本身提供了额外的工具来帮助您提高可访问性；您可以在[上阅读 https://material.angular.io/cdk/a11y/overview](https://material.angular.io/cdk/a11y/overview) 。

利用这些材质特性可能觉得没有必要；但是，在设计应用时，必须考虑响应性、样式化、间距和可访问性问题。Material 团队已经投入了大量的精力，以便您的代码在大多数情况下都能正常工作，并能以高质量的 UX 服务于尽可能多的用户群。这可能包括视障者或键盘主要用户，他们必须依靠专门的软件或键盘功能（如标签）来导航应用。利用材质元素为这些用户提供了至关重要的元数据，使他们能够浏览您的应用。

以下屏幕阅读器软件的材质索赔支持：

*   在 Windows 上使用 Internet Explorer/Firefox/Chrome 的 NVDA 和 JAWS
*   iOS 上的 Safari 和 macOS X 上的 Safari/Chrome 画外音
*   Android 上的 Chrome 对讲

除材质外，您可能需要或希望支持特定的可访问性标准，如基于美国的第 508 节或 W3C 定义的**Web 内容可访问性指南**（**WCAG**）。要求官方支持此类标准需要昂贵的认证和合格的测试人员来确保合规性。

考虑 Pa11y，它是一个自动化可访问性测试的命令行工具。由于它是一个 CLI 工具，您可以轻松地将其与 CI 管道集成。能够在开发周期的早期自动捕获可访问性问题，可以显著降低在应用中实现可访问性功能的成本。

**A11y**是**可访问性**的缩写，因为可访问性一词中*a*和*y*之间有 11 个字符。您可以在[上阅读更多关于为什么无障碍支持很重要的信息 https://a11yproject.com/](https://a11yproject.com/) 。

您可以在[了解更多关于 pa11y 的信息 https://pa11y.org/](https://pa11y.org/) 。接下来，让我们在项目中配置 pa11y CLI 工具。

## 配置自动 pa11y 测试

pa11y 是一个自动辅助功能工具，您可以从命令行执行该工具，根据各种辅助功能规则集（如 Section 508 或 WCAG 2 AAA）检查您的 web 应用。您可以将 pa11y 配置为在本地项目或 CI 服务器上运行。在这两种情况下，都必须针对应用的已部署版本运行测试。

让我们从为本地运行配置 pa11y 开始：

1.  使用以下命令安装 pa11y 和 pa11y ci 软件包：

    ```ts
    npm i -D pa11y pa11y-ci http-server 
    ```

2.  添加`npm`脚本以执行本地运行的 pa11y，检查第 508 节的合规性问题：

    ```ts
    **package.json**
    ...
    "scripts": {
      ...
      "test:a11y": "pa11y --standard Section508 http://localhost:5000"
    } 
    ```

3.  通过执行`npm start`确保应用正在运行。
4.  In a new Terminal window, execute `npm run test:a11y`. The output should be as follows:

    ```ts
    Welcome to Pa11y
     > Running Pa11y on URL http://localhost:5000
    Results for URL: http://localhost:5000/
     • Error: Img element missing an alt attribute. Use the alt attribute to specify a short text alternative.
       ├── Section508.A.Img.MissingAlt
       ├── html > body > app-root > div:nth-child(4) > mat-card > mat-card-content > app-current-weather > div > div:nth-child(2) > div:nth-child(1) > img
       └── <img _ngcontent-pbr-c132="" style="margin-bottom:32px; zoom:175%" src="">        
    1 Errors 
    ```

    注意我们有一个错误。错误消息表明在`app-current-weather`下，我们在`mat-card-content`内显示的图像缺少`alt`属性。请遵守导致错误的以下代码行：

    ```ts
    **src/app/current-weather/current-weather.component.html**
    ...
    <img style="zoom: 175%" [src]="current.image" /> 
    ```

    前面的代码引用了我们从 OpenWeatherMapAPI 获取的图像。如果没有`alt`属性，依赖屏幕阅读器的视力受损用户将无法确定图像的用途。由于这是一个动态图像，像当前天气图标这样的静态`alt`属性会对我们的用户造成伤害。但是，最好将当前天气描述值绑定为属性。我们可以修复可访问性问题，如图所示：

    ```ts
    **src/app/current-weather/current-weather.component.html**
    ...
    <img style="zoom: 175%" [src]="current.image" 
     [alt]="current.description" /> 
    ```

5.  重新运行 pa11y 以确认问题已修复。

现在，依靠屏幕阅读器的用户很快就会发现页面上的图像反映了当前的天气。在本例中，我们的页面上已经有了描述。这是一个需要解决的非常重要的问题，因为在我们的页面上避免出现一整类用户无法破译的神秘元素是至关重要的。

现在让我们为 CI 管道配置 pa11y。

1.  在项目的根目录中创建一个`.pa11yci`配置文件：

    ```ts
    **.pa11yci**
    {
      "default": {
        "timeout": 1000,
        "page": {
          "viewport": {
            "width": 320,
            "height": 480
          }
        }
      },
      "urls": [
        "https://localcast-weather.duluca.now.sh/"
      ]
    } 
    ```

2.  添加`npm`脚本以执行本地运行的 pa11y，检查第 508 节的合规性问题：

    ```ts
    **package.json**
    ...
    "scripts": {
      ...
      "test:a11y:ci": "pa11y-ci"
    } 
    ```

现在我们可以将命令`npm run test:a11y:ci`添加到`.circleci/config.yml`。但是，正如您可能注意到的，我们将针对已经部署的应用版本运行测试。为了克服这个挑战，您必须创建一个替代的`now:publish`命令，将我们的分支部署到不同的 URL，更新`.pa11yci`以检查新的 URL，并在您的管道中执行部署。由于此处涉及的所有操作都是 CLI 命令，因此您可以按顺序执行它们。我将此作为练习留给用户完成。

CircleCI 的更高级用途见*第 9 章*、*使用 Docker 的 DevOps*。接下来，我们将讨论如何构建交互式原型，以便在开发早期发现 UI/UX 问题，从而降低开发成本。

# 构建交互式原型

外表确实重要。无论你是在开发团队工作，还是作为自由职业者，你的同事、老板或客户都会更认真地对待一份精心编排的演示文稿。在*第 3 章**创建一个基本的 Angular 应用*中，我提到了时间和作为一个全栈开发人员的信息管理挑战。我们必须选择一种能够以最少工作量获得最佳结果的工具。这通常意味着使用付费工具，但 UI/UX 设计工具很少是免费或便宜的。

原型工具将帮助您创建一个更好、更专业的应用模型。无论您选择什么工具，都应该支持您选择使用的 UI 框架（在本例中为 Material）。

如果一张图片抵得上千言万语，那么你的应用的一个交互式原型抵得上一千行代码。该应用的交互式模型将帮助您在编写一行代码之前审查想法，并节省大量代码编写时间。

## MockFlow WireframePro

我选择了 MockFlow WireframePro，可在[购买 https://mockflow.com](https://mockflow.com) 作为一个易于使用、功能强大的在线工具，支持材质设计 UI 元素，允许您创建多个页面，然后将这些页面链接在一起，创建一个工作应用的幻觉。

最重要的是，在发布时，MockFlow 允许一个免费项目永远拥有完整的功能集和可用的功能。这将给你一个机会，在没有人为限制或试验期的情况下，真正检查工具的有用性，试验期似乎总是比你预期的要快得多。

Balsamiq（可在[上获得）https://balsamiq.com](https://balsamiq.com) 是一种更知名的线框工具；但是，它不提供任何免费使用。如果你正在寻找一个没有每月费用的工具，我强烈推荐 Balsamiq 的桌面应用模型，它有一次性购买费用。

## 建立模型

我们首先添加一个新任务来创建一个交互式原型，在任务结束时，我会将所有工件附加到此任务，以便它们存储在 GitHub 上，所有团队成员都可以访问它们，并且还可以从 wiki 页面链接以获取持久文档。

让我们将这个新任务拉到**进行中**列，并从 Waffle.io 查看看板板的状态：

![](img/B14094_05_28.png)

图 5.28：当前看板状态

WireframePro 作为一个拖放设计界面非常直观，因此我不会详细介绍该工具的工作原理，但我将重点介绍一些技巧：

1.  创建您的项目
2.  选择组件包，**手绘 UI**或**材质设计**
3.  将每个屏幕添加为新页面，如以下屏幕截图所示：

![](img/B14094_05_29.png)

图 5.29:MockFlow.com 线框专业版

我建议坚持使用手绘 UI 外观，因为它为您的观众设定了正确的期望。如果你在与客户的第一次会面中展示了一个非常高质量的模型，那么你的第一次演示将是轻描淡写的。充其量，你只会达到预期，而最坏的情况，你会让你的观众失去信心。

### 主屏幕

这是我们刚刚创建的主屏幕的新模型：

![](img/B14094_05_30.png)

图 5.30:LocalCast 天气主屏幕线框

你会注意到一些不同之处，比如应用工具栏与浏览器栏混为一谈，重复元素故意含糊不清。我做出这些选择是为了减少在每个屏幕上花费的设计时间。我只是使用水平线和垂直线对象来创建网格。

### 搜索结果

搜索屏幕同样故意保持模糊，以避免维护任何类型的详细信息。令人惊讶的是，您的受众更可能关注您的测试数据，而不是设计元素。

通过含糊其辞，我们故意让观众的注意力集中在重要的事情上。以下是搜索屏幕模型：

![](img/B14094_05_31.png)

图 5.31:LocalCast 天气搜索屏幕线框

### 设置窗格

**设置**窗格是一个独立的屏幕，其中复制了主屏幕中的元素，并应用 85%的不透明度，以创建类似模型的体验。**设置**窗格本身就是一个带有黑色边框和纯白背景的矩形。

请看以下实体模型：

![](img/B14094_05_32.png)

图 5.32:LocalCast 天气设置线框

## 添加交互性

能够在模型周围点击并感受导航工作流程是获得早期用户反馈必不可少的工具。这将为你和你的客户节省大量的挫折、时间和金钱。

要将图元链接在一起，请执行以下操作：

1.  选择一个可点击的元素，如主屏幕上的*档位*图标
2.  在**链接**子目下，点击**选择页面**
3.  在弹出窗口中，选择**设置**
4.  点击**创建链接**，如图所示：

![](img/B14094_05_33.png)

图 5.33：在 Wireframe Pro 中添加链接

现在，当您点击*档位*图标时，工具将显示**设置**页面，这将产生侧边栏实际显示在同一页面上的效果。要返回主屏幕，您可以将*档*图标和侧边栏外的部分链接回该页面，以便用户可以来回导航。

### 导出功能原型

完成原型后，您可以将其导出为各种格式：

1.  Under the **Project** menu, select the **Export Wireframe** button, as shown:

    ![](img/B14094_05_34.png)

    图 5.34:Wireframe Pro 的导出线框菜单选项

2.  Now select your file format, as follows:

    ![](img/B14094_05_35.png)

    图 5.35:Wireframe Pro 中的文件格式

    我更喜欢 HTML 格式的灵活性；但是，您的工作流程和需求会有所不同。

3.  如果选择 HTML，则可以下载所有资产的 ZIP 包。
4.  Unzip the bundle and navigate to it using your browser; you should get an interactive version of your wireframe, as illustrated:

    ![](img/B14094_05_36.png)

    图 5.36:wireframe Pro 中的交互式线框

交互元素以黄色突出显示（打印时为浅灰色），并由前面屏幕截图中的粗箭头指出。您可以使用屏幕左下角的**显示链接**选项启用或禁用此行为。

现在添加所有资产来评论 GitHub 问题，包括 ZIP 包，我们就完成了。

您还可以立即使用 Vercel 发布原型的 HTML 项目，如*第 4 章*、*自动测试、CI 和发布到生产*中所述。

# 总结

在本章中，您学习了什么是角材质、如何使用 Angular Flex 布局引擎、UI 库对性能的影响，以及如何将特定的角材质组件应用于应用。您意识到了过度优化的 UI 设计和单个 CSS 调整的陷阱，以及如何向应用添加自定义主题。

我们还讨论了如何提高应用的可访问性，以及如何构建一个交互式原型，以便在实现设计之前对其进行检查。

在下一章中，我们将更新 weather 应用，以响应用户输入的反应式表单，并保持我们的组件解耦，同时使用`BehaviorSubject`实现它们之间的数据交换。在下一章之后，我们将完成天气应用，并将重点转移到构建更大的业务线应用。

参见*附录 C*、*保持棱角和工具常青*，了解如何升级棱角材质。您可以从[在线找到此附录 https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.pdf](https://static.packt-cdn.com/downloads/9781838648800_Appendix_C_Keeping_Angular_and_Tools_Evergreen.) 或[处 https://expertlysimple.io/stay-evergreen](https://expertlysimple.io/stay-evergreen) 。

# 进一步阅读

*   *疯狂简单：驱动苹果成功的痴迷，肯·塞格尔*2013
*   *材质设计，谷歌*2020，at[https://material.io](https://material.io)
*   *Pa11y，Pa11y 团队*2020，在[处 https://pa11y.org](https://pa11y.org)

# 练习

通过实施替代的 Now 部署，在 CI 管道中实现 pa11y，以便可以针对分支中的更改进行测试。

# 问题

尽可能回答以下问题，以确保您在不使用谷歌搜索的情况下理解了本章的关键概念。你需要帮助回答这些问题吗？参见*附录 D*、*自我评估答案*在线[https://static.packt-cdn.com/downloads/9781838648800_Appendix_D_Self-Assessment_Answers.pdf](https://static.packt-cdn.com/downloads/9781838648800_Appendix_D_Self-Assessment_Answers.pdf) 或访问[https://expertlysimple.io/angular-self-assessment](https://expertlysimple.io/angular-self-assessment) 。

1.  使用角材质有什么好处？
2.  Angular Flex 布局依赖于哪种底层 CSS 技术？
3.  为什么测试可访问性很重要？
4.  为什么要构建一个交互式原型？

